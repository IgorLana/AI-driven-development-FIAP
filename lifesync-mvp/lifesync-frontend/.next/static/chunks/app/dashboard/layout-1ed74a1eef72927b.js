(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[954],{9488:(e,t,s)=>{Promise.resolve().then(s.bind(s,7443))},7443:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>h});var a=s(5155),r=s(2115),o=s(5459),l=s(6046),n=s(8173),c=s.n(n);let i={MANAGER:"MANAGER",ADMIN:"ADMIN"};function h(e){let{children:t}=e,{user:s,loading:n,logout:h}=(0,o.A)(),u=(0,l.useRouter)(),d=(0,l.usePathname)();if((0,r.useEffect)(()=>{n||s||u.push("/login")},[s,n,u]),n)return(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsx)("div",{className:"text-xl text-gray-600",children:"Carregando..."})});if(!s)return null;let g=e=>"block px-6 py-3 transition-colors ".concat(d===e?"bg-blue-100 text-blue-700 font-semibold":"text-gray-700 hover:bg-blue-50 hover:text-blue-600"),m=s.role===i.MANAGER||s.role===i.ADMIN;return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsxs)("div",{className:"fixed inset-y-0 left-0 w-64 bg-white shadow-lg",children:[(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"LifeSync"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:s.name}),(0,a.jsxs)("div",{className:"mt-2 flex items-center gap-2",children:[(0,a.jsxs)("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded-full",children:["Level ",s.level]}),(0,a.jsxs)("span",{className:"text-xs text-gray-600",children:[s.xp," XP"]})]})]}),(0,a.jsxs)("nav",{className:"mt-6",children:[(0,a.jsx)(c(),{href:"/dashboard",className:g("/dashboard"),children:"\uD83D\uDCCA Dashboard"}),(0,a.jsx)(c(),{href:"/dashboard/mood-logs",className:g("/dashboard/mood-logs"),children:"\uD83D\uDE0A Mood Logs"}),(0,a.jsx)(c(),{href:"/dashboard/challenges",className:g("/dashboard/challenges"),children:"\uD83C\uDFAF Desafios"}),(0,a.jsx)(c(),{href:"/dashboard/ranking",className:g("/dashboard/ranking"),children:"\uD83C\uDFC6 Ranking"}),m&&(0,a.jsx)(c(),{href:"/dashboard/analytics",className:g("/dashboard/analytics"),children:"\uD83D\uDCC8 Analytics"})]}),(0,a.jsx)("div",{className:"absolute bottom-0 left-0 right-0 p-6",children:(0,a.jsx)("button",{onClick:h,className:"w-full px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"Sair"})})]}),(0,a.jsx)("div",{className:"ml-64 p-8",children:t})]})}},5459:(e,t,s)=>{"use strict";s.d(t,{A:()=>i,AuthProvider:()=>c});var a=s(5155),r=s(2115),o=s(6046),l=s(5739);let n=(0,r.createContext)(void 0);function c(e){let{children:t}=e,[s,c]=(0,r.useState)(null),[i,h]=(0,r.useState)(!0),u=(0,o.useRouter)();(0,r.useEffect)(()=>{localStorage.getItem("accessToken")?d():h(!1)},[]);let d=async()=>{try{let e=await l.lu.getMe();c(e.data)}catch(e){localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken")}finally{h(!1)}},g=async(e,t,s)=>{let a=(await l.R2.login(e,t,s)).data;localStorage.setItem("accessToken",a.accessToken),localStorage.setItem("refreshToken",a.refreshToken),c(a.user),u.push("/dashboard")},m=async(e,t,s,a)=>{let r=(await l.R2.register(e,t,s,a)).data;localStorage.setItem("accessToken",r.accessToken),localStorage.setItem("refreshToken",r.refreshToken),c(r.user),u.push("/dashboard")},f=async()=>{let e=localStorage.getItem("refreshToken");if(e)try{await l.R2.logout(e)}catch(e){console.warn("Logout remoto falhou:",e.message)}localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),c(null),u.push("/login")};return(0,a.jsx)(n.Provider,{value:{user:s,loading:i,login:g,register:m,logout:f},children:t})}function i(){let e=(0,r.useContext)(n);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},5739:(e,t,s)=>{"use strict";s.d(t,{Ps:()=>u,R2:()=>i,hG:()=>d,lu:()=>h,rh:()=>g});var a=s(423);let r="http://localhost:3001/api/v1",o=a.A.create({baseURL:r,headers:{"Content-Type":"application/json"}});o.interceptors.request.use(e=>{let t=localStorage.getItem("accessToken");return t&&(e.headers.Authorization="Bearer ".concat(t)),e});let l=!1,n=[];function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;n.forEach(s=>{let{resolve:a,reject:r}=s;e?r(e):a(t)}),n=[]}o.interceptors.response.use(e=>e,async e=>{var t;let s=e.config;if((null===(t=e.response)||void 0===t?void 0:t.status)===401&&!s._retry){if(l)return new Promise((e,t)=>{n.push({resolve:e,reject:t})}).then(e=>(s.headers.Authorization="Bearer ".concat(e),o(s)));s._retry=!0,l=!0;let t=localStorage.getItem("refreshToken");if(!t)return localStorage.clear(),window.location.href="/login",Promise.reject(e);try{let{data:e}=await a.A.post("".concat(r,"/auth/refresh"),{refreshToken:t}),l=e.accessToken;return localStorage.setItem("accessToken",l),e.refreshToken&&localStorage.setItem("refreshToken",e.refreshToken),c(null,l),s.headers.Authorization="Bearer ".concat(l),o(s)}catch(e){return c(e,null),localStorage.clear(),window.location.href="/login",Promise.reject(e)}finally{l=!1}}return Promise.reject(e)});let i={login:(e,t,s)=>o.post("/auth/login",{email:e,password:t,companyDomain:s}),register:(e,t,s,a)=>o.post("/auth/register",{name:e,email:t,password:s,companyDomain:a}),refresh:e=>o.post("/auth/refresh",{refreshToken:e}),logout:e=>o.post("/auth/logout",{refreshToken:e})},h={getMe:()=>o.get("/users/me"),getAll:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,s=arguments.length>2?arguments[2]:void 0;return o.get("/users",{params:{page:e,limit:t,role:s}})},update:(e,t)=>o.patch("/users/".concat(e),t)},u={create:(e,t,s)=>o.post("/mood-logs",{mood:e,tags:t,note:s}),getHistory:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:7,t=arguments.length>1?arguments[1]:void 0;return o.get("/mood-logs/history",{params:{limit:e,...t?{cursor:t}:{}}})}},d={getDaily:()=>o.get("/challenges/daily"),complete:e=>o.post("/challenges/".concat(e,"/complete")),create:e=>o.post("/challenges",e)},g={getMoodSummary:(e,t)=>o.get("/analytics/mood-summary",{params:{startDate:e,endDate:t}})}}},e=>{var t=t=>e(e.s=t);e.O(0,[423,28,441,517,358],()=>t(9488)),_N_E=e.O()}]);