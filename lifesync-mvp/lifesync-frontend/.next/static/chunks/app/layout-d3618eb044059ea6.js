(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{9860:(e,t,o)=>{Promise.resolve().then(o.bind(o,5459)),Promise.resolve().then(o.t.bind(o,5299,23)),Promise.resolve().then(o.t.bind(o,9324,23))},5459:(e,t,o)=>{"use strict";o.d(t,{A:()=>u,AuthProvider:()=>c});var r=o(5155),a=o(2115),s=o(6046),n=o(5739);let l=(0,a.createContext)(void 0);function c(e){let{children:t}=e,[o,c]=(0,a.useState)(null),[u,i]=(0,a.useState)(!0),h=(0,s.useRouter)();(0,a.useEffect)(()=>{localStorage.getItem("accessToken")?g():i(!1)},[]);let g=async()=>{try{let e=await n.lu.getMe();c(e.data)}catch(e){localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken")}finally{i(!1)}},m=async(e,t,o)=>{let r=(await n.R2.login(e,t,o)).data;localStorage.setItem("accessToken",r.accessToken),localStorage.setItem("refreshToken",r.refreshToken),c(r.user),h.push("/dashboard")},f=async(e,t,o,r)=>{let a=(await n.R2.register(e,t,o,r)).data;localStorage.setItem("accessToken",a.accessToken),localStorage.setItem("refreshToken",a.refreshToken),c(a.user),h.push("/dashboard")},d=async()=>{let e=localStorage.getItem("refreshToken");if(e)try{await n.R2.logout(e)}catch(e){console.warn("Logout remoto falhou:",e.message)}localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),c(null),h.push("/login")};return(0,r.jsx)(l.Provider,{value:{user:o,loading:u,login:m,register:f,logout:d},children:t})}function u(){let e=(0,a.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},5739:(e,t,o)=>{"use strict";o.d(t,{Ps:()=>h,R2:()=>u,hG:()=>g,lu:()=>i,rh:()=>m});var r=o(423);let a="http://localhost:3001/api/v1",s=r.A.create({baseURL:a,headers:{"Content-Type":"application/json"}});s.interceptors.request.use(e=>{let t=localStorage.getItem("accessToken");return t&&(e.headers.Authorization="Bearer ".concat(t)),e});let n=!1,l=[];function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;l.forEach(o=>{let{resolve:r,reject:a}=o;e?a(e):r(t)}),l=[]}s.interceptors.response.use(e=>e,async e=>{var t;let o=e.config;if((null===(t=e.response)||void 0===t?void 0:t.status)===401&&!o._retry){if(n)return new Promise((e,t)=>{l.push({resolve:e,reject:t})}).then(e=>(o.headers.Authorization="Bearer ".concat(e),s(o)));o._retry=!0,n=!0;let t=localStorage.getItem("refreshToken");if(!t)return localStorage.clear(),window.location.href="/login",Promise.reject(e);try{let{data:e}=await r.A.post("".concat(a,"/auth/refresh"),{refreshToken:t}),n=e.accessToken;return localStorage.setItem("accessToken",n),e.refreshToken&&localStorage.setItem("refreshToken",e.refreshToken),c(null,n),o.headers.Authorization="Bearer ".concat(n),s(o)}catch(e){return c(e,null),localStorage.clear(),window.location.href="/login",Promise.reject(e)}finally{n=!1}}return Promise.reject(e)});let u={login:(e,t,o)=>s.post("/auth/login",{email:e,password:t,companyDomain:o}),register:(e,t,o,r)=>s.post("/auth/register",{name:e,email:t,password:o,companyDomain:r}),refresh:e=>s.post("/auth/refresh",{refreshToken:e}),logout:e=>s.post("/auth/logout",{refreshToken:e})},i={getMe:()=>s.get("/users/me"),getAll:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,o=arguments.length>2?arguments[2]:void 0;return s.get("/users",{params:{page:e,limit:t,role:o}})},update:(e,t)=>s.patch("/users/".concat(e),t)},h={create:(e,t,o)=>s.post("/mood-logs",{mood:e,tags:t,note:o}),getHistory:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:7,t=arguments.length>1?arguments[1]:void 0;return s.get("/mood-logs/history",{params:{limit:e,...t?{cursor:t}:{}}})}},g={getDaily:()=>s.get("/challenges/daily"),complete:e=>s.post("/challenges/".concat(e,"/complete")),create:e=>s.post("/challenges",e)},m={getMoodSummary:(e,t)=>s.get("/analytics/mood-summary",{params:{startDate:e,endDate:t}})}},6046:(e,t,o)=>{"use strict";var r=o(6658);o.o(r,"usePathname")&&o.d(t,{usePathname:function(){return r.usePathname}}),o.o(r,"useRouter")&&o.d(t,{useRouter:function(){return r.useRouter}})},9324:()=>{},5299:e=>{e.exports={style:{fontFamily:"'Inter', 'Inter Fallback'",fontStyle:"normal"},className:"__className_f367f3"}}},e=>{var t=t=>e(e.s=t);e.O(0,[618,423,441,517,358],()=>t(9860)),_N_E=e.O()}]);